

-----

# Auto Update Worker - GitHub Actions 自动化更新脚本

[](https://www.google.com/search?q=https://github.com/YOUR_USERNAME/YOUR_REPOSITORY/actions/workflows/up.yml)

这是一个通用的 GitHub Actions 工作流，旨在自动从指定的上游仓库（）拉取最新的 Release 文件，并将其更新到你自己的仓库中。

它非常适合用于自动同步 Cloudflare Worker、前端静态资源或任何其他通过 GitHub Release 发布的文件，确保你的项目始终保持最新。

## ✨ 主要功能

  - **自动化定时检查**：默认配置为每6小时自动运行一次，检查是否有新版本发布。
  - **多种触发方式**：
      - 定时自动触发。
      - 当 `main` 分支有 `push` 操作时触发。
      - 支持在 Actions 页面手动触发。
  - **手动强制更新**：在手动触发时，可以选择忽略版本检查，强制拉取并覆盖文件。
  - **清晰的日志记录**：工作流的每一步都有详细的日志输出，方便追踪和调试。
  - **自动提交变更**：当文件更新后，脚本会自动将变更提交到你的仓库，并附带规范的提交信息。
  - **高度可配置**：你可以轻松修改环境变量来指定任何你想要跟踪的上游仓库和文件名。

## ⚙️ 工作原理

1.  **触发工作流**：当预设的触发条件（定时、push、手动）满足时，工作流启动。
2.  **检出代码**：首先，工作流会检出你仓库的当前代码。
3.  **版本比较**：
      - 读取你仓库根目录下的 `version.txt` 文件，获取本地版本号。
      - 通过 GitHub API 获取上游仓库（``）的最新 Release 的 `tag_name` 作为远程版本号。
4.  **判断更新**：
      - 如果远程版本号与本地版本号不同，或者你手动触发了“强制更新”，则继续执行。
      - 如果版本相同且未强制更新，则工作流正常结束，不执行任何操作。
5.  **下载与解压**：
      - 从最新的 Release 中找到名为 `worker.zip` 的文件并下载。
      - 解压 `worker.zip`，并覆盖仓库中的现有文件。
6.  **更新与提交**：
      - 将上游仓库的最新版本号写入本地的 `version.txt` 文件。
      - 使用 `git-auto-commit-action` 将所有变动（更新的文件和 `version.txt`）自动提交到你的仓库。

## 🚀 如何使用

你可以将这个工作流应用到你自己的仓库中，只需按照以下步骤操作：

### 1\. 配置 GitHub Actions

在你的仓库根目录下创建 `.github/workflows` 文件夹，并在此文件夹中创建一个名为 `up.yml` 的文件。然后将完整的脚本代码粘贴到 `up.yml` 文件中。

目录结构如下：

```
.
├── .github/
│   └── workflows/
│       └── up.yml      <-- 将脚本代码粘贴在这里
└── ... (其他文件)
```



你也可以修改 `schedule` 部分的 `cron` 表达式来调整自动检查的频率。

### 4\. 启用 Actions 并查看结果

完成以上步骤后，工作流将根据你设置的触发条件自动运行。你可以在仓库的 **"Actions"** 标签页中查看所有运行记录。

#### 手动运行工作流

1.  进入仓库的 **"Actions"** 标签页。
2.  在左侧边栏找到名为 **"Auto Update Worker"** 的工作流。
3.  点击 **"Run workflow"** (运行工作流) 按钮。
4.  你可以选择是否勾选 **"是否强制更新"** 选项，然后再次点击绿色的 **"Run workflow"** 按钮来启动。

## 📝 许可证

此脚本本身使用 [MIT License](https://www.google.com/search?q=LICENSE) 授权。请注意，通过此脚本下载的文件遵循其原始仓库的许可证。
